var appOwin;
(function (appOwin) {
    'use strict';
    angular.module('owin', ['ngRoute']);
})(appOwin || (appOwin = {}));
var appOwin;
(function (appOwin) {
    'use strict';
    function start($rootScope) {
        var uToken = localStorage.getItem('Utoken');
        if (!uToken) {
            $rootScope.UToken = null;
        }
        else {
            $rootScope.UToken = angular.fromJson(uToken);
        }
    }
    start.$inject = ['$rootScope'];
    angular.module('owin').run(start);
})(appOwin || (appOwin = {}));
var appOwin;
(function (appOwin) {
    'use strict';
    var Config = (function () {
        function Config($routeProvider) {
            $routeProvider.when('/login', {
                controllerAs: 'vm',
                controller: 'LoginCtrl',
                templateUrl: '/login.html'
            }).when('/', {
                controllerAs: 'vm',
                controller: 'HomeCtrl',
                templateUrl: '/wwwroot/pages/home.html'
            }).when('/Theming', {
                controllerAs: 'vm',
                controller: 'ThemingCtrl',
                templateUrl: '/wwwroot/pages/Theming.html'
            }).otherwise({
                controllerAs: 'vm',
                controller: 'HomeCtrl',
                templateUrl: '/wwwroot/pages/404.html'
            });
        }
        Config.$inject = ['$routeProvider'];
        return Config;
    }());
    appOwin.Config = Config;
    angular.module('owin', ['ngRoute']).config(Config);
})(appOwin || (appOwin = {}));
var appOwin;
(function (appOwin) {
    'use strict';
})(appOwin || (appOwin = {}));
var appOwin;
(function (appOwin) {
    'use strict';
    var UserToken = (function () {
        function UserToken(title, userName, token) {
            this.title = title;
            this.userName = userName;
            this.token = token;
        }
        return UserToken;
    }());
    appOwin.UserToken = UserToken;
})(appOwin || (appOwin = {}));
var appOwin;
(function (appOwin) {
    var BearerAuthIntercepto = (function () {
        function BearerAuthIntercepto($q, $window) {
            this.$q = $q;
            this.$window = $window;
        }
        BearerAuthIntercepto.prototype.request = function (config) {
            config.headers = config.headers || {};
            if (this.$window.localStorage.getItem('Utoken')) {
                config.headers.Authorization = 'Bearer ' + this.$window.localStorage.getItem('Utoken');
            }
            return config || this.$q.when(config);
        };
        BearerAuthIntercepto.prototype.response = function (response) {
            if (response.status === 401) {
                this.$window.location.href = 'http://localhost:10498/login.html';
            }
            return response || this.$q.when(response);
        };
        BearerAuthIntercepto.$inject = ['$q', '$window'];
        return BearerAuthIntercepto;
    }());
    appOwin.BearerAuthIntercepto = BearerAuthIntercepto;
    angular.module('owin').factory('BearerAuthIntercepto', BearerAuthIntercepto);
})(appOwin || (appOwin = {}));
var appOwin;
(function (appOwin) {
    'use strict';
    var ProfileCtrl = (function () {
        function ProfileCtrl($scope, $local, $http) {
            this.$scope = $scope;
            this.$local = $local;
            this.$http = $http;
        }
        ProfileCtrl.prototype.Logout = function () {
            window.localStorage.removeItem('Utoken');
            window.location.href = 'http://localhost:10498/login.html';
        };
        ProfileCtrl.$inject = ['$scope', '$location', '$http'];
        return ProfileCtrl;
    }());
    appOwin.ProfileCtrl = ProfileCtrl;
    angular.module('owin').controller('ProfileCtrl', ProfileCtrl);
})(appOwin || (appOwin = {}));
var appOwin;
(function (appOwin) {
    'use strict';
    var HomeCtrl = (function () {
        function HomeCtrl(scope) {
            this.$scope = scope;
        }
        HomeCtrl.$inject = ["$scope"];
        return HomeCtrl;
    }());
    appOwin.HomeCtrl = HomeCtrl;
    angular.module('owin').controller('HomeCtrl', HomeCtrl);
})(appOwin || (appOwin = {}));
var appOwin;
(function (appOwin) {
    'use strict';
    var ThemingCtrl = (function () {
        function ThemingCtrl(scope) {
            this.$scope = scope;
        }
        ThemingCtrl.$inject = ['$scope'];
        return ThemingCtrl;
    }());
    appOwin.ThemingCtrl = ThemingCtrl;
    angular.module('owin').controller('ThemingCtrl', ThemingCtrl);
})(appOwin || (appOwin = {}));
var appOwin;
(function (appOwin) {
    'use strict';
    var LoginCtrl = (function () {
        function LoginCtrl(scope, local, http) {
            this.$scope = scope;
            this.$location = local;
            this.$http = http;
            this.login = { email: "alison@amorim.com", pass: "testando" };
            this.$scope.login = this.login;
        }
        LoginCtrl.prototype.Send = function () {
            var data = "grant_type=password&username=" + this.$scope.login.email + "&password=" + this.$scope.login.pass;
            this.$http.post('http://localhost:10498/server/api/security/token', data, { headers: { 'Content-Type': 'application/x-www-form-urlencoded' } })
                .success(function (result) {
                console.log(result);
                window.localStorage.setItem('Utoken', JSON.stringify(result));
                window.location.href = 'http://localhost:10498/';
            });
        };
        LoginCtrl.$inject = ['$scope', '$location', '$http'];
        return LoginCtrl;
    }());
    appOwin.LoginCtrl = LoginCtrl;
    angular.module('owin').controller('LoginCtrl', LoginCtrl);
})(appOwin || (appOwin = {}));
